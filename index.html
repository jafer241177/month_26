<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>الاختبار الإلكتروني</title>
   <style>
    body { 
        font-family: Tahoma; 
        margin: 30px; 
    }

    #examSection { 
        display: none; 
    }

    .question {
        padding: 15px;
        border: 1px solid #ccc;
        margin-bottom: 20px;
        border-radius: 6px;
        background: #fff;
        text-align: right;
    }

    .question h4 {
        margin-bottom: 10px;
        font-size: 20px;
        font-weight: bold;
    }

    /* هذا هو السر الذي يرجّع الشكل القديم */
    .option {
        display: block;          /* كل اختيار في سطر */
        margin: 6px 0;
        font-size: 18px;
        cursor: pointer;
    }

    .option input[type="radio"] {
        margin-left: 6px;        /* الدائرة تلتصق بالنص */
        transform: scale(1.3);   /* تكبير الدائرة */
        vertical-align: middle;  /* محاذاة الدائرة مع النص */
    }
</style>

</head>
<body>

    <!-- تسجيل الدخول -->
    <div id="loginSection">
        <h2>تسجيل الدخول</h2>
        <input id="studentId" placeholder="أدخل رقم السجل المدني">
        <br>
        <button onclick="login()">دخول</button>
    </div>

    <!-- قسم الاختبار -->
    <div id="examSection">

        <div id="studentInfoBox" style="
            padding:15px;
            background:#f0f0f0;
            border-radius:8px;
            margin-bottom:20px;
        ">
            <h3>بيانات الطالب</h3>
            <p><b>الاسم:</b> <span id="sName"></span></p>
            <p><b>الصف:</b> <span id="sGrade"></span></p>
            <p><b>الفصل:</b> <span id="sClass"></span></p>
        </div>

        <h3>الأسئلة</h3>
        <div id="questionsContainer"></div>

        <button onclick="submitExam()">إرسال الإجابات</button>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
      const firebaseConfig = {
        apiKey: "YOUR_KEY",
        authDomain: "YOUR_DOMAIN",
        databaseURL: "https://quiz26-caf2f-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "quiz26-caf2f",
        storageBucket: "quiz26-caf2f.appspot.com",
        messagingSenderId: "YOUR_SENDER",
        appId: "YOUR_APP_ID"
      };

      firebase.initializeApp(firebaseConfig);
    </script>

<script>
    async function login() {
        const id = document.getElementById("studentId").value.trim();

        // 1) دخول المعلم أولاً
        if (id === "teacher2026") {
            window.location.href = "report.html";
            return;
        }

        // 2) التحقق من أن الطالب أدخل رقم
        if (id.length === 0) {
            alert("الرجاء إدخال رقم السجل المدني");
            return;
        }

        // 3) تحميل بيانات الطلاب من JSON
        const response = await fetch("students-data.json");
        const students = await response.json();

        // البحث عن الطالب
        const student = students.find(s => s.id == id);

        if (!student) {
            alert("رقم السجل المدني غير صحيح");
            return;
        }

        // 4) التحقق هل الطالب حل الاختبار مسبقًا من Firebase
        firebase.database().ref("month/" + id).once("value", snapshot => {
            if (snapshot.exists()) {
                alert("لقد قمت بحل الاختبار مسبقًا ولا يمكنك الدخول مرة أخرى");
                return;
            }

            // 5) دخول الطالب لأول مرة فقط
            localStorage.setItem("studentId", id);

            document.getElementById("loginSection").style.display = "none";
            document.getElementById("examSection").style.display = "block";

            loadStudentData(id);
            loadQuestions();
        });
    }
</script>



    <!-- ملف السكربت الرئيسي -->
    <script src="script.js"></script>

</body>
</html>
